<html>
<head>
  <script type='application/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js'></script>
  <script type='application/javascript'>
	$(document).ready(function() {

	  websocket = 'ws://localhost:9999/ws';
	  if (window.WebSocket) {
		ws = new WebSocket(websocket);
	  }
	  else if (window.MozWebSocket) {
		ws = MozWebSocket(websocket);
	  }
	  else {
		console.log('WebSocket Not Supported');
		return;
	  }

	  window.onbeforeunload = function(e) {
		ws.close(1000, '');
			 
		if(!e) e = window.event;
		e.stopPropagation();
		e.preventDefault();
	  };
	  ws.onmessage = function (evt) {
		var box = $('#chat');
		box.val(box.val() + evt.data + '\n');
		box.animate({scrollTop: box[0].scrollHeight - box.height()});
	  };
	  ws.onopen = function() {
	  };
	  ws.onclose = function(evt) {
		 $('#chat').val($('#chat').val() + 'Connection closed by server: ' + evt.code + ' \"' + evt.reason + '\"\n');  
	  };

	/* $('#send').click(function() {
		 console.log($('#message').val());
		 ws.send($('#message').val());
		 $('#message').val("");
		 return false;
		 });
	*/
	});
  </script>
</head>
<body style="margin: 0; padding: 0;">
<form action='#' id='chatform' method='get' style="margin: 0; padding: 0;">
	<textarea id='chat' cols='35' rows='10' style="width: 100%; height: 100%; margin: 0; padding: 0;"></textarea>
	<!--
  <br />
  <label for='message'>Send: </label><input type='text' id='message' />
  <input id='send' type='submit' value='Send' />
  -->
  </form>
</body>
</html>

